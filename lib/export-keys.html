<script type="text/javascript">
    RED.nodes.registerType('export-keys', {
        category: 'EJBCA',
        color: "rgb(204, 204, 51)",
        defaults: {
            name: {value: ""},
            outputDirectory_fieldType: {value: "str"},
            outputDirectory: {value: "/path/to/output/directory", required: true},
            privatefileName_fieldType: {value: "str"},
            privatefileName: {value: "private_key", required: true},
            publicfileName_fieldType: {value: "str"},
            publicfileName: {value: "public_key", required: true},
            privateKey_fieldType: {value: "str"},
            privateKey: {value: "ejbca.privateKey", required: true},
            publicKey_fieldType: {value: "str"},
            publicKey: {value: "ejbca.publicKey", required: true},
        },
        inputs: 1,
        outputs: 0,
        icon: "icons/2-file-export-solid.svg",
        label: function () {
            return this.name || "export-keys";
        },
        oneditprepare: function () {
            $("#node-input-outputDirectory").typedInput({
                default: 'str',
                types: ['msg', 'global', 'flow', 'str'],
                typeField: $("#node-input-outputDirectory_fieldType")
            });

            $("#node-input-privatefileName").typedInput({
                default: 'str',
                types: ['msg', 'global', 'flow', 'str'],
                typeField: $("#node-input-privatefileName_fieldType")
            });

            $("#node-input-publicfileName").typedInput({
                default: 'str',
                types: ['msg', 'global', 'flow', 'str'],
                typeField: $("#node-input-publicfileName_fieldType")
            });

            $("#node-input-privateKey").typedInput({
                default: 'msg',
                types: ['msg', 'global', 'flow', 'str'],
                typeField: $("#node-input-privateKey_fieldType")
            });

            $("#node-input-publicKey").typedInput({
                default: 'msg',
                types: ['msg', 'global', 'flow', 'str'],
                typeField: $("#node-input-publicKey_fieldType")
            });
        }
    });
</script>

<script type="text/html" data-help-name="export-keys">
    <p>A node that exports a generated keypair to a defined location on the file system.</p>
    <p>The nodes utilizes the generated keys in msg.ejbca.privateKey and publicKey</p>
</script>

<!-- Content of the configuration dialog -->
<script type="text/html" data-template-name="export-keys">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>

    <div class="form-row">
        <label for="node-input-outputDirectory"><i class="fa fa-folder"></i> Output Directory</label>
        <input type="text" id="node-input-outputDirectory" placeholder="/path/to/output/directory" style="width:250px;">
        <input type="hidden" id="node-input-outputDirectory_fieldType">
    </div>

    <div class="form-row">
        <label for="node-input-privatefileName"><i class="fa fa-file"></i> Private Key Filename</label>
        <input type="text" id="node-input-privatefileName" placeholder="private_key" value="private_key"
               style="width:250px;">
        <input type="hidden" id="node-input-privatefileName_fieldType">
    </div>

    <div class="form-row">
        <label for="node-input-publicfileName"><i class="fa fa-file"></i> Public Key Filename </label>
        <input type="text" id="node-input-publicfileName" placeholder="public_key" value="public_key"
               style="width:250px;">
        <input type="hidden" id="node-input-publicfileName_fieldType">
    </div>

    <div class="form-row">
        <label for="node-input-privateKey"><i class="fa fa-key"></i> Private Key</label>
        <input type="text" id="node-input-privateKey" placeholder="private_key_location" value="ejbca.private_key"
               style="width:250px;">
        <input type="hidden" id="node-input-privateKey_fieldType">
    </div>

    <div class="form-row">
        <label for="node-input-publicKey"><i class="fa fa-key"></i> Public Key</label>
        <input type="text" id="node-input-publicKey" placeholder="public_key_location" value="ejbca.public_key"
               style="width:250px;">
        <input type="hidden" id="node-input-publicKey_fieldType">
    </div>
</script>
